<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Validación de Certificados</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
    }
    .contenedor {
      max-width: 500px;
      margin: 50px auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      cursor: pointer;
    }
    #resultado p {
      margin: 8px 0;
    }
  </style>
</head>
<body>

  <div class="contenedor">
    <h2>Validación de Certificados</h2>

    <input type="text" id="busqueda" placeholder="Ingrese DNI o Folio">
    <button onclick="buscarCertificado()">Buscar</button>

    <div id="resultado"></div>
  </div>

  <script>
    function buscarCertificado() {
      const valor = document.getElementById("busqueda").value.trim();
      const resultado = document.getElementById("resultado");

      if (valor === "") {
        resultado.innerHTML = "<p>Ingrese un DNI o Folio</p>";
        return;
      }

      // ⚠️ PEGA AQUÍ TU LINK CSV PUBLICADO
      const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT6D5oCcn_PDfFSdPotCyMUW4mgzGCPTrgIMTJLKvcrJO0GDKIlc2nr8PdV2s4JNL2b3y6eVui_k9Kl/pub?gid=0&single=true&output=csv";

      fetch(url)
        .then(response => response.text())
        .then(data => {
          const filas = data.split("\n");
          let encontrado = false;

          for (let i = 1; i < filas.length; i++) {
            const columnas = filas[i].split(",");

            if (columnas[0] === valor || columnas[2] === valor) {
              resultado.innerHTML = `
                <p><strong>Nombre:</strong> ${columnas[1]}</p>
                <p><strong>Curso:</strong> ${columnas[3]}</p>
                <p><strong>Periodo:</strong> ${columnas[4]}</p>
                <p><strong>Folio:</strong> ${columnas[2]}</p>
                <a href="${columnas[5]}" target="_blank">Ver certificado</a>
              `;
              encontrado = true;
              break;
            }
          }

          if (!encontrado) {
            resultado.innerHTML = "<p>No se encontró ningún certificado</p>";
          }
        })
        .catch(error => {
          resultado.innerHTML = "<p>Error al cargar los datos</p>";
          console.error(error);
        });
    }
  </script>

</body>
</html>
